# Session Summary — 2026-02-19

## /boot Hardening (CIS 1.4.2, ANSSI R28/R29)

**Open:** mount.mounted for fstab may need explicit device/fstype when /boot is a separate partition — left for real server configuration.

New `security/boot.sls` state created to restrict `/boot` directory (0700), `/boot/grub` (0700), `grub.cfg` (0600), kernel images/initrd/System.map/symvers (0600 root:root). `config-*` left at 0644 (low sensitivity). Mount options `nosuid,nodev,noexec` for `/boot` moved to new `base/fstab.sls` (natural home for future mount hardening). `noauto` explicitly rejected to avoid breaking kernel updates.

## Package Purging — GUI/Desktop, Audio, Bluetooth

`security/packages.sls` extended with six new `pkg.purged` blocks: desktop task meta-packages (all `task-*-desktop` variants), X.org/X11, display managers (gdm3/sddm/lightdm/xdm/lxdm/slim), desktop-pulled services (avahi-daemon, cups), audio (pulseaudio, pipewire, alsa), and bluetooth (bluez, blueman).

## Kernel Module Blacklist Extensions

**Open:** firewire-core (1.1.1.9) not yet blacklisted.

ATM and CAN added to existing network protocol blacklist (alongside DCCP/SCTP/RDS/TIPC). Wireless modules added: `cfg80211`, `mac80211` (blocks all Wi-Fi at framework level), `bluetooth`, `btusb` (complements package purge). Compliance entries 3.1.2 and 3.1.3 updated to reflect module-level enforcement.

## IPv6 Disable (CIS 3.1.1, ANSSI R13)

IPv6 disabled via `net.ipv6.conf.all.disable_ipv6=1` and `net.ipv6.conf.default.disable_ipv6=1` in `99-hardening.conf`. Controlled by new `kernel:ipv6_disable` pillar key (default: True). Set to False to re-enable (requires ensuring firewall rules cover IPv6).

## cron.yearly

`security/cron.sls` extended to include `cron.yearly` in the directory permissions loop (0700, not created if missing).

## PAM — Strong Password Hashing (CIS 5.3.3.4.3)

New `pam-common-password` file created with `pam_unix.so` using `yescrypt` (memory-hard, preferred over sha512) + `obscure` + `use_authtok`. Wired into `security/pam.sls`.

## Shell Hardening (CIS 5.4.3.1, 5.4.3.3, ANSSI R36)

**Open:** 5.4.3.2 (TMOUT shell timeout) not yet implemented. 5.4.2.6 (root umask) not explicitly set.

`/etc/shells` cleaned of nologin entries via idempotent `sed` in `shell/bash.sls`. umask 0027 set in new `/etc/profile.d/umask.sh` drop-in (covers all login shells); combined with existing `pam_umask.so umask=0027` in `common-session`.

## CIS 7.1.11 — World-Writable Files

**Open:** Implementation deferred. Decision: audit-only (cron alert) rather than blind remediation. World-writable files should be scanned everywhere including /run /tmp /var/tmp (no legitimate use for o+w on regular files). World-writable directories without sticky bit to exclude /tmp /var/tmp /run themselves.

## Compliance Updates

compliance.md updated for all items implemented today: 1.4.2, 2.4.1.7, 3.2.1, 3.2.2, 3.1.1, 5.3.3.4.3 (note corrected), 5.4.3.1, 5.4.3.3, R13, R28, R29, R36.
