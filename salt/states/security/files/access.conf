# CIS 5.4.1 — Login access control
# Managed by Salt — do not edit manually
#
# Format: permission : users/groups : origins
# Only pillar-defined users are permitted. All others are denied.

# Allow root on local console only (tty1-tty6, no pts)
+ : root : tty1 tty2 tty3 tty4 tty5 tty6

# admin is hardcoded — guaranteed access regardless of pillar rendering
+ : admin : ALL

# Allow all other pillar-managed users from any origin
{% for username, user in salt['pillar.get']('users', {}).items() %}
{% if username != 'admin' %}
+ : {{ username }} : ALL
{% endif %}
{% endfor %}

# Deny everything else
- : ALL : ALL
